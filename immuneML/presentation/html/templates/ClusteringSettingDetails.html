<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Split {{split_number}} - {{setting_name}} Details</title>
    <style>
        {{{css_style}}}

        .back-link {
            margin-bottom: 1em;
        }

        .back-link a {
            color: var(--accent-color, teal);
            text-decoration: none;
        }

        .back-link a:hover {
            text-decoration: underline;
        }

        .section {
            margin: 2em 0;
            padding: 1.5em;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: #fafafa;
        }

        .section h2 {
            margin-top: 0;
            border-bottom: 2px solid var(--accent-color, teal);
            padding-bottom: 0.5em;
        }

        .table-container {
            overflow-x: auto;
            margin: 1em 0;
        }

        .table-container table {
            width: 100%;
            border-collapse: collapse;
        }

        .table-container th, .table-container td {
            padding: 0.5em;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .plot-container {
            width: 100%;
            max-width: 900px;
            margin: 1.5em 0;
        }

        .plot-container embed, .plot-container iframe {
            width: 100%;
            height: 500px;
            border: none;
            border-radius: 4px;
        }

        .plot-container img {
            max-width: 100%;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .download-link {
            display: inline-block;
            margin: 0.5em 0;
            padding: 0.5em 1em;
            background: var(--accent-color, teal);
            color: white;
            text-decoration: none;
            border-radius: 4px;
        }

        .download-link:hover {
            background: #006666;
        }

        .report-section {
            margin: 1.5em 0;
            padding: 1em;
            background: white;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        .download-list {
            list-style: none;
            padding: 0;
        }

        .download-list li {
            margin: 0.3em 0;
        }

        .download-list li a {
            color: var(--accent-color, teal);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="back-link">
            <a href="{{main_page_link}}">&larr; Back to main page</a>
        </div>

        <h1>Split {{split_number}} - {{setting_name}}</h1>

        <!-- Predictions Section -->
        <div class="section">
            <h2>Predictions</h2>
            {{#predictions_path}}
            <p><a class="download-link" href="{{predictions_path}}" download>Download Full Predictions CSV</a></p>
            {{/predictions_path}}

            {{#predictions_table}}
            <p>Preview (first 20 rows):</p>
            <div class="table-container" style="overflow-x: auto; overflow-y: scroll; max-height: 500px;">
                {{{predictions_table}}}
            </div>
            {{/predictions_table}}
            {{^predictions_table}}
            <p>No predictions available.</p>
            {{/predictions_table}}
        </div>

        <!-- Performance Section -->
        <div class="section">
            <h2>Performance Metrics</h2>

            <h3>Internal Performance</h3>
            {{#internal_performance}}
            <div class="table-container">
                {{{internal_performance}}}
            </div>
            {{/internal_performance}}
            {{^internal_performance}}
            <p>No internal performance metrics available.</p>
            {{/internal_performance}}

            <h3>External Performance</h3>
            {{#external_performance}}
            <div class="table-container">
                {{{external_performance}}}
            </div>
            {{/external_performance}}
            {{^external_performance}}
            <p>No external performance metrics available.</p>
            {{/external_performance}}
        </div>

        <!-- Reports Section -->
        {{#reports.has_reports}}
        <div class="section">
            <h2>Reports</h2>
            {{#reports.reports}}
            <div class="report-section">
                <h3>{{name}}</h3>
                {{#show_info}}
                <p>{{info}}</p>
                {{/show_info}}

                {{#output_figures}}
                <div class="plot-container">
                    {{#name}}<h4>{{name}}</h4>{{/name}}
                    {{#is_embed}}
                    <iframe src="{{path}}"></iframe>
                    {{/is_embed}}
                    {{^is_embed}}
                    <img src="{{path}}" alt="{{name}}">
                    {{/is_embed}}
                </div>
                {{/output_figures}}

                {{#show_tables}}
                <h4>Downloadable Tables</h4>
                <ul class="download-list">
                    {{#output_tables}}
                    <li><a href="{{download_link}}" download>{{file_name}}</a> - {{name}}</li>
                    {{/output_tables}}
                </ul>
                {{/show_tables}}

                {{#show_text}}
                <h4>Text Reports</h4>
                <ul class="download-list">
                    {{#output_text}}
                    <li><a href="{{download_link}}" download>{{file_name}}</a></li>
                    {{/output_text}}
                </ul>
                {{/show_text}}
            </div>
            {{/reports.reports}}
        </div>
        {{/reports.has_reports}}
    </div>
</body>
</html>